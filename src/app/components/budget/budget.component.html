<div *ngIf="user" class="dashboard">

  <mat-card class="mt-4 balance-card">

    <form #frmBudget="ngForm" class="mt-3">
      <mat-radio-group name="period">
        <mat-radio-button value="M" checked="true">Monthly</mat-radio-button>
        <mat-radio-button value="BW">Bi weekly</mat-radio-button>
      </mat-radio-group>
    </form>

    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a (click)="setExpenseActive(true)" 
        [ngClass]="isExpenseActive ? 'nav-link active' : 'nav-link text-info'">Revenue entries</a>
      </li>
      <li class="nav-item">
        <a (click)="setExpenseActive(false)" 
        [ngClass]="!isExpenseActive ? 'nav-link active' : 'nav-link text-info'" >Fixed expenses</a>
      </li>
    </ul>

    <div *ngIf="isExpenseActive">

      <form #frmRevenue="ngForm" class="mt-3">
        
        <mat-form-field appearance="fill" class="w-50">
          <mat-label>Description</mat-label>
          <input matInput  
          name="revenueDescription" #revenueDescription="ngModel" [(ngModel)]="newRevenue.description"
          required>
        </mat-form-field>
  
        <mat-form-field appearance="fill" class="ml-3 w-25">
          <mat-label>Amount</mat-label>
          <input matInput matInput 
          name="revenueAmount" #revenueAmount="ngModel" [(ngModel)]="newRevenue.amount"
          required pattern="^[1-9]{1}[0-9]*((.[0-9]+){0,1}|0(.[0-9]+){1,})$" >
        </mat-form-field>
        
        <button mat-mini-fab color="basic" class="ml-3 mb-3" (click)="saveRevenue()">
          <mat-icon class="text-info">note_add</mat-icon> 
        </button>      
  
      </form>

      <table mat-table [dataSource]="revenueDataSource" class="mat-elevation-z8 w-100 table-hover">
        <tr mat-header-row *matHeaderRowDef="revenueDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: revenueDisplayedColumns;"></tr>

        <ng-container matColumnDef="Description">
          <th mat-header-cell *matHeaderCellDef >Description</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell w-50"> {{element.description}} </td>
        </ng-container>

        <ng-container matColumnDef="Amount">
          <th mat-header-cell *matHeaderCellDef >Amount</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell w-25"> {{element.amount | balanceFormat}} </td>
        </ng-container>

        <ng-container matColumnDef="Edit / Delete">
          <th mat-header-cell *matHeaderCellDef >Edit / Delete</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell w-25"> 
            <button mat-icon-button color="primary" >
              <mat-icon class="text-info">edit</mat-icon>
            </button>
            <button mat-icon-button color="accent" >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

      </table>
    </div>

    <div *ngIf="!isExpenseActive">
      
      <form #frmExpense="ngForm" class="mt-3">
  
        <mat-form-field appearance="fill" class="form-item w-25"> 
          <mat-label>Expense type</mat-label>
          <mat-select #type="ngModel" [(ngModel)]="fixedExpense.expenseTypeId" name="type">
            <mat-option *ngFor="let type of expenseTypes" [value]="type.expenseTypeId">
              {{type.description}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill" class="ml-3 w-25">
          <mat-label>Description</mat-label>
          <input matInput  
          name="description" #description="ngModel" [(ngModel)]="fixedExpense.description"
          required>
        </mat-form-field>
  
        <mat-form-field appearance="fill" class="ml-3 w-25">
          <mat-label>Amount</mat-label>
          <input matInput matInput name="amount"
          #amount="ngModel" [(ngModel)]="fixedExpense.amount"
          required pattern="^[1-9]{1}[0-9]*((.[0-9]+){0,1}|0(.[0-9]+){1,})$">
        </mat-form-field>
        
        <button mat-mini-fab color="basic" class="ml-3 mb-3" (click)="addFixedExpense()">
          <mat-icon class="text-info">note_add</mat-icon> 
        </button>      
  
      </form>
      
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-100 mt-3 table-hover">
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  
        <ng-container matColumnDef="Expense type">
          <th mat-header-cell *matHeaderCellDef >Expense type</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell"> {{getExpenseTypeDescription(element.expenseTypeId)}} </td>
        </ng-container>
  
        <ng-container matColumnDef="Description">
          <th mat-header-cell *matHeaderCellDef >Description</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell w-25"> {{element.description}} </td>
        </ng-container>
  
        <ng-container matColumnDef="Amount">
          <th mat-header-cell *matHeaderCellDef >Amount</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell w-25"> {{element.amount | balanceFormat}} </td>
        </ng-container>
  
        <ng-container matColumnDef="Edit / Delete">
          <th mat-header-cell *matHeaderCellDef >Edit / Delete</th>
          <td mat-cell *matCellDef="let element" class="mat-header-cell w-25"> 
            <button mat-icon-button color="primary" >
              <mat-icon class="text-info">edit</mat-icon>
            </button>
            <button mat-icon-button color="accent" >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>
  
      </table>
    </div>

  </mat-card>

</div>


<ngx-spinner></ngx-spinner>